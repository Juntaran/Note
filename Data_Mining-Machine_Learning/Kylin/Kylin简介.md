# Kylin 简介

Apache Kylin 是 Hadoop 大数据平台的一个开源 `OLAP` 引擎，采用多维立方体预计算计数，能够把大数据的 SQL 查询速度提高到亚秒级别  

> OLAP: 联机分析处理，侧重决策支持，实时性要求不高  
> OLTP: 联机事务处理，关系数据库，具有实时性  

## 为什么使用 Kylin

### 现今优化点: 

1. 大规模并行处理，以 `Hive` 为代表，调动多台机器一起并行计算，用线性增加的资源来换取计算时间的下降    
2. 列式存储将记录按列存放，如此可以再访问时只读取需要的列，还可以利用存储设备擅长于连续读取的特点，大大提高读取速率  

### Kylin 解决方案

Kylin 的初衷是为了解决`千亿、万亿`记录的`秒级查询`问题  

`OLAP` 具有以下两个特点:  

1. 大数据查询要的是多条记录经过聚合函数计算后的统计值，不需要原始数据  
2. 数据的聚合是按照维度的，因为业务范围和分析需求是有限的，因此有意义的维度聚合组合也是相对有限的，不会随着数据的膨胀而增长  

因此可以采用`预计算`方案，尽量多地预先计算聚合结果，在查询的时候尽量使用预算的结果而得出查询结果，从而避免直接扫描可能无限增长的原始记录  

## Kylin 的工作原理

维度组合: 

一个数据集如果有 4 个维度，那么所有维度的组合有 2^4 = 16  

> 零维度有 1 种  
> 一维度有 4 种  
> 二维度有 C4/2 = 6 种    
> 三维度有 C4/3 = 4 种  
> 四纬度有 1 种   

Kylin 会对数据模型进行预计算，并利用计算的结果加速查询  

1. 指定数据模型，定义维度和度量  
2. 预计算 Cube，计算所有 Cuboid 并保存为物化视图  
3. 执行查询时，读取 Cuboid ，运算，产生查询结果  

### Cube 和 Cuboid 

对于一个有 N 个维度的数据集来说，可能有 2^N 种组合  
对于每一种维度的组合，将度量做聚合运算，然后把运算的结果保存为一个物化视图，称之为 `Cuboid`  
所有维度组合的 Cuboid 作为一个整体，称为 `Cube`  
一个 Cube 就是许多按照维度聚合的物化视图的集合  













